<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FLO Scout</title>
  <link rel="stylesheet" href="css/main.css" />
</head>

<body data-theme="dark">
  <div id="loader_page" class="hide-completely">
    <svg id="loader" class="icon" viewBox="0 0 64 64">
      <title>Loading</title>
      <circle cx="32" cy="32" r="32" />
    </svg>
    <h4>Loading</h4>
  </div>
  <header id="page_header" class="flex margin">
    <h3 id="page_title">Block</h3>
    <svg id="secondary_search_btn" class="icon margin-left-auto hover" viewBox="0 0 64 64">
      <title>
        search for block, transactions, address, token or contract
      </title>
      <circle cx="25.34" cy="25.34" r="24.84" />
      <line x1="63.65" y1="63.65" x2="42.91" y2="42.91" />
    </svg>
  </header>
  <main id="page_container">
    <!--<div id="search_page" class="page hide-completely">
            <label id="secondary_search" class="input">
                <svg class="icon" viewBox="0 0 64 64">
                    <title>search icon</title>
                    <circle cx="25.34" cy="25.34" r="24.84"/>
                    <line x1="63.65" y1="63.65" x2="42.91" y2="42.91"/>
                </svg>
                <input type="search" placeholder="Search block, transactions, address, token or contract">
            </label>
        </div>
            <div id="all_transations" class="">

            </div>
            <div id="all_blocks" class="">

            </div>  -->
  </main>

  <script>
    let frag = document.createDocumentFragment();
    const create = {
      homepage(obj) {
        let { topToken, totalTransactions, walletAddresses, topContract, } = obj,
          page = document.createElement("div");
        page.classList.add("page");
        page.id = "homepage";
        page.innerHTML = `
              <section id="first_section">
              <header class="header flex">
                  <div id="logo">
                      <svg id="main_logo" viewBox="0 0 27.25 32">
                          <title>RanchiMall</title>
                          <path d="M27.14,30.86c-.74-2.48-3-4.36-8.25-6.94a20,20,0,0,1-4.2-2.49,6,6,0,0,1-1.25-1.67,4,4,0,0,1,0-2.26c.37-1.08.79-1.57,3.89-4.55a11.66,11.66,0,0,0,3.34-4.67,6.54,6.54,0,0,0,.05-2.82C20,3.6,18.58,2,16.16.49c-.89-.56-1.29-.64-1.3-.24a3,3,0,0,1-.3.72l-.3.55L13.42.94C13,.62,12.4.26,12.19.15c-.4-.2-.73-.18-.72.05a9.39,9.39,0,0,1-.61,1.33s-.14,0-.27-.13C8.76.09,8-.27,8,.23A11.73,11.73,0,0,1,6.76,2.6C4.81,5.87,2.83,7.49.77,7.49c-.89,0-.88,0-.61,1,.22.85.33.92,1.09.69A5.29,5.29,0,0,0,3,8.33c.23-.17.45-.29.49-.26a2,2,0,0,1,.22.63A1.31,1.31,0,0,0,4,9.34a5.62,5.62,0,0,0,2.27-.87L7,8l.13.55c.19.74.32.82,1,.65a7.06,7.06,0,0,0,3.46-2.47l.6-.71-.06.64c-.17,1.63-1.3,3.42-3.39,5.42L6.73,14c-3.21,3.06-3,5.59.6,8a46.77,46.77,0,0,0,4.6,2.41c.28.13,1,.52,1.59.87,3.31,2,4.95,3.92,4.95,5.93a2.49,2.49,0,0,0,.07.77h0c.09.09,0,.1.9-.14a2.61,2.61,0,0,0,.83-.32,3.69,3.69,0,0,0-.55-1.83A11.14,11.14,0,0,0,17,26.81a35.7,35.7,0,0,0-5.1-2.91C9.37,22.64,8.38,22,7.52,21.17a3.53,3.53,0,0,1-1.18-2.48c0-1.38.71-2.58,2.5-4.23,2.84-2.6,3.92-3.91,4.67-5.65a3.64,3.64,0,0,0,.42-2A3.37,3.37,0,0,0,13.61,5l-.32-.74.29-.48c.17-.27.37-.63.46-.8l.15-.3.44.64a5.92,5.92,0,0,1,1,2.81,5.86,5.86,0,0,1-.42,1.94c0,.12-.12.3-.15.4a9.49,9.49,0,0,1-.67,1.1,28,28,0,0,1-4,4.29C8.62,15.49,8.05,16.44,8,17.78a3.28,3.28,0,0,0,1.11,2.76c.95,1,2.07,1.74,5.25,3.32,3.64,1.82,5.22,2.9,6.41,4.38A4.78,4.78,0,0,1,21.94,31a3.21,3.21,0,0,0,.14.92,1.06,1.06,0,0,0,.43-.05l.83-.22.46-.12-.06-.46c-.21-1.53-1.62-3.25-3.94-4.8a37.57,37.57,0,0,0-5.22-2.82A13.36,13.36,0,0,1,11,21.19a3.36,3.36,0,0,1-.8-4.19c.41-.85.83-1.31,3.77-4.15,2.39-2.31,3.43-4.13,3.43-6a5.85,5.85,0,0,0-2.08-4.29c-.23-.21-.44-.43-.65-.65A2.5,2.5,0,0,1,15.27.69a10.6,10.6,0,0,1,2.91,2.78A4.16,4.16,0,0,1,19,6.16a4.91,4.91,0,0,1-.87,3c-.71,1.22-1.26,1.82-4.27,4.67a9.47,9.47,0,0,0-2.07,2.6,2.76,2.76,0,0,0-.33,1.54,2.76,2.76,0,0,0,.29,1.47c.57,1.21,2.23,2.55,4.65,3.73a32.41,32.41,0,0,1,5.82,3.24c2.16,1.6,3.2,3.16,3.2,4.8a1.94,1.94,0,0,0,.09.76,4.54,4.54,0,0,0,1.66-.4C27.29,31.42,27.29,31.37,27.14,30.86ZM6.1,7h0a3.77,3.77,0,0,1-1.46.45L4,7.51l.68-.83a25.09,25.09,0,0,0,3-4.82A12,12,0,0,1,8.28.76c.11-.12.77.32,1.53,1l.63.58-.57.84A10.34,10.34,0,0,1,6.1,7Zm5.71-1.78A9.77,9.77,0,0,1,9.24,7.18h0a5.25,5.25,0,0,1-1.17.28l-.58,0,.65-.78a21.29,21.29,0,0,0,2.1-3.12c.22-.41.42-.76.44-.79s.5.43.9,1.24L12,5ZM13.41,3a2.84,2.84,0,0,1-.45.64,11,11,0,0,1-.9-.91l-.84-.9.19-.45c.34-.79.39-.8,1-.31A9.4,9.4,0,0,1,13.8,2.33q-.18.34-.39.69Z"/>
                      </svg>
                      <h4>RanchiMall</h4>
                  </div>
                  <label class="toggle" style="margin-left: auto" title="Change theme">
                      <input type="checkbox" name="theme toggle" id="theme_toggle">
                      <div class="switch">
                          <svg class="circle" viewBox="0 0 64 64">
                              <title>dark theme</title>
                              <path d="M48.25,45.45A27.26,27.26,0,0,1,20.82,18.37,26.75,26.75,0,0,1,27.47.71a31.71,31.71,0,0,0-27,31.2,31.8,31.8,0,0,0,32,31.59A32,32,0,0,0,63.12,41.12,27.59,27.59,0,0,1,48.25,45.45Z" transform="translate(0 0)"/>
                          </svg>
                          <svg class="circle" viewBox="0 0 64 64">
                              <title>light theme</title>
                              <circle cx="32" cy="32" r="13.9"/>
                              <line x1="32" y1="6.86" x2="32"/>
                              <line x1="32" y1="64" x2="32" y2="57.14"/>
                              <line x1="57.14" y1="32" x2="64" y2="32"/>
                              <line y1="32" x2="6.86" y2="32"/>
                              <line x1="49.78" y1="14.22" x2="54.63" y2="9.37"/>
                              <line x1="9.37" y1="54.63" x2="14.22" y2="49.78"/>
                              <line x1="49.78" y1="49.78" x2="54.63" y2="54.63"/>
                              <line x1="9.37" y1="9.37" x2="14.22" y2="14.22"/>
                          </svg>
                      </div>
                  </label>
              </header>
              <div id="main_search">
                  <h1 class="other-font">FLO SCOUT</h1>
                  <h3>Search for<br>block, transaction, address,<br>token and contract</h3>
                  <label id="primary_search" class="input">
                      <svg class="icon" viewBox="0 0 64 64">
                          <title>search icon</title>
                          <circle cx="25.34" cy="25.34" r="24.84"/>
                          <line x1="63.65" y1="63.65" x2="42.91" y2="42.91"/>
                      </svg>
                      <input id='main-search-text' type="search" placeholder="Search">
                  </label>
                  <div id="suggetions"></div>
              </div>
          <div id="highlights">
              <div class="highlight-item">
                  <h4 class="label">top token</h4>
                  <h2 class="token">${topToken}</h2>
              </div>
              <div class="highlight-item">
                  <h4 class="label">total transactions</h4>
                  <h2>${totalTransactions}</h2>
              </div>
              <div class="highlight-item">
                  <h4 class="label">Wallet addresses</h4>
                  <h2>${walletAddresses}</h2>
              </div>
              <div class="highlight-item">
                  <h4 class="label">top contract</h4>
                  <h2 class="contract">${topContract.name}</h2>
              </div>
          </div>
      </section>
      <section id="latest_transaction_section">
          <header class="grid grid-2 header">
              <h3 class="heading">Latest transactions</h3>
              <button id='all_trans_btn' class="margin-left-auto">view all</button>
          </header>
          <div id="top_transaction_container">
          </div>
      </section>
      <section id="latest_blocks_section">
          <header class="grid grid-2 header">
              <h3 class="heading">Latest blocks</h3>
              <button id='all_blocks_btn' class="margin-left-auto">view all</button>
          </header>
          <div id="top_blocks_container">
          </div>
      </section>
              `;
        return page;
      },
      blockPage(obj) {
        let { blockHeight, size, transactions, reward, hash, difficulty, nonce,
        } = obj,
          page = document.createElement("div"),
          wordForm = "transaction";
        if (transactions > 1) wordForm = "transactions";
        page.classList.add("page");
        page.id = "block_page";

        page.innerHTML = `
              <h5 class="label">Block Height</h5>
              <h2 class="block-height">${blockHeight}</h2>
              <div class="card">
                  <h4>1 ${wordForm}</h4>
                  <h5 class="label">${size}</h5>
                  <h5 class="label">Reward</h5>
                  <h4>${reward}</h4>
                  <h5 class="label">Hash</h5>
                  <h4 class="breakable hash">${hash}</h4>
                  <h5 class="label">Difficulty</h5>
                  <h4>${difficulty}</h4>
                  <h5 class="label">Nonce</h5>
                  <h4>${nonce}</h4>
              </div>
              <h3 class="heading">Transactions</h3>
              <div id="block_transaction_container" class="top-bottom-padding">
              </div>`;
        return page;
      },
      addressPage(obj) {
        let { balance, address } = obj,
          page = document.createElement("div");
        page.classList.add("page");
        page.id = "address_page";
        page.innerHTML = `
              <div class="balance-card">
                  <svg class="flo-logo" viewBox="0 0 48 48">
                      <path d="M34.2,32.4c0,0,3.75-0.18,7.41-3.86c2.96-2.98,3.65-6.66,3.99-8.52c-11.04-0.63-12.36,0.99-13.71,1.68
                      c-1.19,0.61-5.33,4.55-5.33,4.55s3.06-3.13,3.2-9.94c0.09-4.54-1.02-7.39-2.72-10.64C25.29,2.33,22.79,0,22.79,0l0.01,4.97
                      c0,0,4.35,2.84,4.35,11.84c0,6.52-4.35,11.02-4.35,11.02s-4.35-4.5-4.35-11.02c0-9.01,4.35-11.84,4.35-11.84L22.79,0
                      c0,0-2.48,2.33-4.23,5.67c-1.7,3.25-2.81,6.1-2.72,10.64c0.13,6.81,3.2,9.94,3.2,9.94s-4.14-3.95-5.33-4.55
                      c-1.35-0.69-2.67-2.31-13.71-1.68c0.34,1.86,1.03,5.54,3.99,8.52c3.66,3.68,7.41,3.86,7.41,3.86s-5.05-2.03-7.15-9.45
                      c0,0,5.76-0.7,9.63,1.87c2.52,1.67,4.86,4.26,6.79,6.01c0,0-2.58-0.04-6.81,1.88c-2.54,1.15-3.92,2.84-4.44,4.38
                      c-0.36,1.06-0.2,2.27-0.2,2.27s3.31,0.31,5.94,0c1.99-0.23,3.42-2.16,3.42-2.16s-2,0.78-3.95,0.78c-2.06,0-2.67-0.66-2.67-0.66
                      c0.98-3.64,8.68-5.19,8.68-5.19s-1.34,2.6-1.42,6.5c-0.1,4.79,3.57,8.52,3.57,8.45c0,0.07,3.67-3.66,3.57-8.45
                      c-0.08-3.9-1.42-6.5-1.42-6.5s7.71,1.55,8.68,5.19c0,0-0.61,0.66-2.67,0.66c-1.95,0-3.95-0.78-3.95-0.78s1.43,1.93,3.42,2.16
                      c2.63,0.31,5.94,0,5.94,0s0.16-1.21-0.2-2.27c-0.52-1.54-1.9-3.23-4.44-4.38c-4.23-1.92-6.81-1.88-6.81-1.88
                      c1.93-1.76,4.27-4.34,6.79-6.01c3.87-2.57,9.63-1.87,9.63-1.87C39.26,30.38,34.2,32.4,34.2,32.4z M22.8,43.06
                      c-0.95-1.37-1.47-2.13-1.47-4.26c0-2.4,1.12-4.61,1.47-5.14c0.35,0.52,1.47,2.74,1.47,5.14C24.27,40.92,23.75,41.69,22.8,43.06z"/>
                  </svg>
                  <h5 class="label">Balance</h5>
                  <h2>${balance}</h2><h4>FLO</h4>
                  <p class="breakable">${address}</p>
              </div>
              <h3 class="heading">Transactions</h3>
              <div id="address_transaction_container" class="top-bottom-padding">
              </div>`;
        return page;
      },
      transactionPage(obj) {
        let { type, name, blockHeight, amount, sender, receiver, floData, hash, confirmations, } = obj,
          page = document.createElement("div");
        page.classList.add("page");
        page.id = "transaction_page";
        page.innerHTML = `
              <div class="grid grid-2">
                  <div>
                      <h5 class="label">${type}</h5>
                      <h2 class="token">${name}</h2>
                  </div>
                  <div class="status done">
                      <svg class="icon" viewBox="0 0 64 42">
                          <title>Success</title>
                          <polyline points="0.35 19.41 22.4 41.29 63.65 0.35"/>
                      </svg>
                      Success
                  </div>
              </div>
              <div class="card">
                  <h5 class="label">Block</h5>
                  <h4 class="block-height">${blockHeight}</h4>
                  <h5 class="label">Amount</h5>
                  <h4>${amount}</h4>
                  <h5 class="label">Sender</h5>
                  <h4 class="address">${sender}</h4>
                  <h5 class="label">Reciever</h5>
                  <h4 class="address">${receiver}</h4>
              </div>
              <div class="card">
                  <h5 class="label">FLO Data</h5>
                  <p>${floData}</p>
                  <h5 class="label">Hash</h5>
                  <h4 class="breakable hash">${hash}</h4>
                  <h5 class="label">Block Confirmations</h5>
                  <h4>${confirmations}</h4>
              </div>
              `;
        return page;
      },
      tokenPage(obj) {
        let { token, supply, incAddress } = obj;
        let page = document.createElement("div");
        page.classList.add("page");
        page.id = "token_page";
        page.innerHTML = `
                <div class="card">
                  <h2 class="uppercase">${token}</h2>
                  <h5 class="label">Supply</h5>
                  <h4>${supply}</h4>
                  <h5 class="label">Incorporation Address</h5>
                  <h4 class="breakable">${incAddress}</h4>
                </div>
                <div class="tabs">
                    <h4 class="tab active" data-rank="1" data-target="token_balance_container">Top Balances</h4>
                    <h4 class="tab" data-rank="2" data-target="token_transaction_container">Top Transactions</h4>
                    <div class="line"></div>
                </div>
                <ul id="token_balance_container" data-tab-group="token" class="card">
                    <li class="balance" >
                        <h5 class="breakable label">F6EMAHjivqrcrdAHNABq2R1FLNkx8xfEaT</h5>
                        <h4>0.0000023333 RMT</h4>
                    </li>
                    <li class="balance">
                        <h5 class="breakable label">F6EMAHjivqrcrdAHNABq2R1FLNkx8xfEaT</h5>
                        <h4>0.0000023333 RMT</h4>
                    </li>
                </ul>
                <ul id="token_transaction_container" data-tab-group="token" class="card hide-completely">
                    <li class="balance" >
                        <h5 class="breakable label">F6EMAHjivqrcrdAHNABq2R1FLNkx8xfEaT</h5>
                        <h4>0.0000023333 RMT</h4>
                    </li>
                </ul>
              `;
        return page;
      },
      contractPage(obj) {
        let { status, contract, contractType, incAddress, expiration, token, participationFees } = obj,
          page = document.createElement("div");
        page.classList.add("page");
        page.id = "contract_page";
        page.innerHTML = `
              <div class="status closed">Closed</div>
              <h2 class="uppercase">${contract}</h2>
              <div class="card">
                  <h5 class="label">Contract Type</h5>
                  <h4>${contractType}</h4>
                  <h5 class="label">Incorporation Address</h5>
                  <h4 class="address">${incAddress}</h4>
                  <h5 class="label">Expiration</h5>
                  <h4>${expiration}</h4>
                  <h5 class="label">Token Used</h5>
                  <h4 class="uppercase">${token}</h4>
                  <h5 class="label">Participation Amount</h5>
                  <h4>${participationFees}</h4>
              </div>
              <h3 class="heading">User Choices</h3>
              <ul class="card" type='circle'>
                  <li>Narendra Modi Wins</li>
                  <li>Narendra Modi Loses</li>
              </ul>
              <div class="tabs">
                  <h4 class="tab active" data-rank="1" data-target="participant_container">Participants</h4>
                  <h4 class="tab" data-rank="2" data-target="winners_container">Winners</h4>
                  <h4 class="tab" data-rank="3" data-target="losers_container">losers</h4>
                  <div class="line"></div>
              </div>
              <ul id="participant_container" data-tab-group="token" class="card">
                  <li class="contract-choice" >
                      <h5 class="breakable label">F6EMAHjivqrcrdAHNABq2R1FLNkx8xfEaT</h5>
                      <h3>narendra modi wins</h3>
                      <h4>0.0000023333 RMT</h4>
                  </li>
                  <li class="balance">
                      <h5 class="breakable label">F6EMAHjivqrcrdAHNABq2R1FLNkx8xfEaT</h5>
                      <h4>0.0000023333 RMT</h4>
                  </li>
              </ul>
              <ul id="winners_container" data-tab-group="token" class="card hide-completely">
                  <li class="contract-choice winner" >
                      <h5 class="breakable label">F6EMAHjivqrcrdAHNABq2R1FLNkx8xfEaT</h5>
                      <h3>narendra modi wins</h3>
                      <h4>0.0000023333 RMT</h4>
                  </li>
              </ul>
              <ul id="losers_container" data-tab-group="token" class="card hide-completely">
                  <li class="contract-choice winner" >
                      <h5 class="breakable label">F6EMAHjivqrcrdAHNABq2R1FLNkx8xfEaT</h5>
                      <h3>narendra modi wins</h3>
                      <h4>0.0000023333 RMT</h4>
                  </li>
              </ul>
              `;
        return page;
      },
      contractTransferCard(obj) {
        let { hash, blockHeight, token, sender, receiver, amount, contractName, userChoice } = obj,
          card = document.createElement("div");
        card.classList.add("transaction", "token-transfer");
        card.id = hash;
        card.innerHTML = `
                              <h5 class="label block-height">${blockHeight}</h5>
                              <div class="contract-type">
                                  <h5 class="label">Smart Contract Transfer</h5>
                                  <h4 class="token uppercase">${token}</h4>
                              </div>
                              <div class="contract-info">
                                  <h5 class="label">Sender</h5>
                                  <h4 class="address">${sender}</h4>
                                  <h5 class="label">receiver</h5>
                                  <h4 class="address">${receiver}</h4>
                                  <h5 class="label">amount</h5>
                                  <h4>${amount} ${token}</h4>
                                  <h5 class="label">Contract name</h5>
                                  <h4>${contractName}</h4>`;
        if (userChoice)
          card.innerHTML += `
                                  <h5 class="label">User Choice</h5>
                                  <h4>${userChoice}</h4>`;

        card.innerHTML += `</div>`;
        return card;
      },
      tokenTransferCard(obj) {
        let { hash, blockHeight, token, sender, receiver, amount } = obj,
          card = document.createElement("div");
        card.classList.add("transaction", "token-transfer");
        card.id = hash;
        card.innerHTML = `
                              <h5 class="label block-height">${blockHeight}</h5>
                              <div class="contract-type">
                                  <h5 class="label">Token transfer</h5>
                                  <h4 class="token uppercase">${token}</h4>
                              </div>
                              <div class="contract-info">
                                  <h5 class="label">Sender</h5>
                                  <h4 class="address">${sender}</h4>
                                  <h5 class="label">receiver</h5>
                                  <h4 class="address">${receiver}</h4>
                                  <h5 class="label">amount</h5>
                                  <h4>${amount} ${token}</h4>
                              </div>`;
        return card;
      },
      tokenCreationCard(obj) {
        let { hash, blockHeight, token, incAddress, supply } = obj,
          card = document.createElement("div");
        card.classList.add("transaction", "token-creation");
        card.id = hash;
        card.innerHTML = `
                              <h5 class="label block-height">${blockHeight}</h5>
                              <div class="contract-type">
                                  <h5 class="label">token creation</h5>
                                  <h4 class="token uppercase">${token}</h4>
                              </div>
                              <div class="contract-info">
                                  <h5 class="label">Incorporation address</h5>
                                  <h4>${incAddress}</h4>
                                  <h5 class="label">token name</h5>
                                  <h4 class="uppercase">${token}</h4>
                                  <h5 class="label">supply</h5>
                                  <h4>${supply}</h4>
                              </div>`;
        return card;
      },
      contractTriggerCard(obj) {
        let { hash, blockHeight, contractName, contractAddress, winningChoice, committeeAddress } = obj,
          card = document.createElement("div");
        card.classList.add("transaction", "contract-trigger");
        card.id = hash;
        card.innerHTML = `
                              <h5 class="label block-height">${blockHeight}</h5>
                              <div class="contract-type">
                                  <h4 class="token uppercase">smart contract trigger</h4>
                              </div>
                              <div class="contract-info">
                                  <h5 class="label">Contract name</h5>
                                  <h4>${contractName}</h4>
                                  <h5 class="label">contract address</h5>
                                  <h4 class="address">${contractAddress}</h4>
                                  <h5 class="label">Winning Choice</h5>
                                  <h4>${winningChoice}</h4>
                                  <h5 class="label">committee address</h5>
                                  <h4>${committeeAddress}</h4>
                              </div>`;
        return card;
      },
      contractCreationCard(obj) {
        let { hash, blockHeight, token, contractName, incAddress, contractType, expiration, participationFees, availableChoices } = obj,
          card = document.createElement("div");
        card.classList.add("transaction", "contract-creation");
        card.id = hash;
        card.innerHTML = `
                              <h5 class="label block-height">${blockHeight}</h5>
                              <div class="contract-type">
                                  <h5 class="label">Smart Contract creation</h5>
                                  <h4 class="token uppercase">${token}</h4>
                              </div>
                              <div class="contract-info">
                                  <h5 class="label">Contract name</h5>
                                  <h4>${contractName}</h4>
                                  <h5 class="label">Incorporation address</h5>
                                  <h4>${incAddress}</h4>
                                  <h5 class="label">token used</h5>
                                  <h4 class="uppercase">${token}</h4>
                                  <h5 class="label">contract type</h5>
                                  <h4>${contractType}</h4>
                                  <h5 class="label">expiration</h5>
                                  <h4 class="address">${expiration}</h4>
                                  <h5 class="label">participation amount</h5>
                                  <h4>${participationFees} ${token}</h4>
                                  <h5 class="label">user Choices</h5>
                                  <div class="choices-container">`;
        if (availableChoices)
          availableChoices.forEach((choice) => {
            card.innerHTML += `<div class="choice">${choice}</div>`;
          });
        card.innerHTML += `  </div>
                              </div>`;
        return card;
      },
    };

    const pageTitle = document.getElementById("page_title"),
      pageContainer = document.getElementById("page_container"),
      pageHeader = document.getElementById("page_header");
    let currentPage = "homepage",
      prevField = "";

    function removePage() {
      if (pageContainer.firstElementChild)
        pageContainer.firstElementChild.remove();
    }

    function replaceDash(string) {
      return string.replace(/-/g, " ");
    }

    let appState = {
      page: "homepage",
      thisField: null,
    };

    window.onpopstate = (e) => {
      if (e.state !== null) {
        let { page, thisField } = e.state;
        render(page, thisField);
      }
    };

    async function render(pageId, field) {
      if ("scrollRestoration" in history) {
        history.scrollRestoration = "manual";
      }
      window.scrollTo(0, 0);
      loading(true)
      removePage(currentPage);

      if (pageId === "address_page") {
        /*let addressInfo = await getAddressInfo(field);
        let addressBalance = await getAddressBalance(field);
        let addressTxs = await getAddressTxs(field);*/
        let [addressInfo, addressBalance, addressTxs] = await Promise.all([getAddressInfo(field), getAddressBalance(field), getAddressTxs(field)])
        console.log(addressInfo, addressBalance, addressTxs)
        pageContainer.append(create.addressPage({balance: addressBalance, address: field}))
        pageTitle.textContent = 'Address'
        loading()
      }

      if (pageId === "token_page") {
        //console.time('data')
        //console.timeLog('data')
        /*let tokenInfo = await getTokenInfo(field);
        let tokenBalances = await getTokenBalances(field);
        let tokenTransactions = await getTokenTransactions(field);*/
        let [tokenInfo, tokenBalances, tokenTransactions] = await Promise.all([getTokenInfo(field), getTokenBalances(field), getTokenTransactions(field)])
        //console.timeEnd('data')

        /*for(bal in tokenBalances){
          console.log(bal, tokenBalances[bal])
        }
        for(tx in tokenTransactions){
          console.log(tx, tokenTransactions[tx])
        }*/
        pageContainer.append(create.tokenPage(tokenInfo));
        pageTitle.textContent = "Token";
        loading()
      }

      if (pageId === "contract_page") {
        // todo: load contract variable dynamically
        let contract = {
          name: "india-elections-2019",
          address: "F7osBpjDDV1mSSnMNrLudEQQ3cwDJ2dPR1",
        };

        let contractInfo = await getContractInfo(contract);
        // todo : check the type of contract & then further checks like fetching details of contractParticipant 
        let contractTransactions = await getContractTransactions(contract);
        let contractParticipants = await getContractParticipants(contract);
        let obj = {
          status: "closed",
          contract: "india-elections-2019",
          contractType: "one-time-event",
          incAddress: "F7osBpjDDV1mSSnMNrLudEQQ3cwDJ2dPR1",
          expiration: "wed may 22 2019 21:00:00 gmt+0530",
          token: "rmt",
          participationFees: "0.001 RMT",
        };
        pageContainer.append(create.contractPage(obj));
        pageTitle.textContent = "Contract";
        loading()
      }

      if (pageId === "block_page") {
        let blockInfo = await getBlockInfo(field);
        pageContainer.append(create.blockPage(blockInfo));
        pageTitle.textContent = "block";
        loading()
      }

      if (pageId === "homepage") {
        // banner
        pageHeader.classList.add("hide-completely");
        let [data, latestTxs, latestBlocks] = await Promise.all([getBannerData(), getLatestTxs(), getLatestBlocks()])
        pageContainer.append(create.homepage(data));
        loading();

        // add event listener to input dialog box
        document.getElementById("main-search-text").addEventListener("keydown", function (e) {
            if (e.key === 'Enter') {  //checks whether the pressed key is "Enter"
                processNavbarSearch();
            }
        });

        let themeToggler = document.getElementById("theme_toggle"),
          body = document.querySelector("body");
        if (localStorage.theme === "dark") {
          nightlight();
          themeToggler.checked = true;
        } else {
          daylight();
          themeToggler.checked = false;
        }
        function daylight() {
          body.setAttribute("data-theme", "light");
        }
        function nightlight() {
          body.setAttribute("data-theme", "dark");
        }
        themeToggler.addEventListener("change", () => {
          if (themeToggler.checked) {
            nightlight();
            localStorage.setItem("theme", "dark");
          } else {
            daylight();
            localStorage.setItem("theme", "light");
          }
        });

        latestTxs.forEach(tx => {
          if (tx["type"] == "tokentransfer") 
            frag.append(create.tokenTransferCard(tx))
          else if (tx["type"] == "contracttransfer")
            frag.append(create.contractTransferCard(tx));
        })
        document.getElementById("top_transaction_container").append(frag);

        // todo - add latest blocks
      } else pageHeader.classList.remove("hide-completely");

      if (pageId === "viewallblocks") {
        let latest100blocks = await getLatestBlocks();
        loading()
      }

      if (pageId === "viewalltxs") {
        let latest100txs = await getViewallTxs();
        loading()

      }

      if (pageId === "transaction_page") {
        let latest100txs = await getTxDetails();
        loading()
      }

      currentPage = pageId;
      prevField = field;
      if (pageContainer.querySelector('.tab.active'))
        pageContainer.querySelector('.tab.active').click()
      tabMounted = false;
    }

    function renderTransactions() { }

    window.addEventListener("load", () => {
      render("homepage");
      history.pushState(appState, null, null);

      document.querySelector("main").addEventListener("click", (e) => {
        if (e.target.closest(".address") && prevField !== e.target.textContent) {
          render("address_page", e.target.textContent)
          appState = {
            page: "address_page",
            thisField: e.target.textContent,
          };
          history.pushState(appState, null, null)
        }
        if (e.target.closest(".token") && prevField !== e.target.textContent) {
          render("token_page", e.target.textContent.toLowerCase());
          appState = { page: "token_page", thisField: e.target.textContent};
          history.pushState(appState, null, null)
        }
        if (e.target.closest(".hash") && prevField !== e.target.textContent) {
          render("transaction_page", e.target.textContent);
          appState = {
            page: "transaction_page",
            thisField: e.target.textContent,
          };
          history.pushState(appState, null, null)
        }
        if (e.target.closest(".block-height") && prevField !== e.target.textContent) {
          render("block_page", e.target.textContent);
          appState = { page: "block_page", thisField: e.target.textContent };
          history.pushState(appState, null, null);
        }
        if (e.target.closest(".contract") && prevField !== e.target.textContent) {
          render("contract_page", e.target.textContent)
          appState = {
            page: "contract_page",
            thisField: e.target.textContent,
          }
          history.pushState(appState, null, null)
        }
        if (e.target.closest(".tab")) {
          showTab(e.target.closest(".tab"));
        }
        if (e.target.closest("#secondary_search")) {
          render("homepage");
          document.getElementById("primary_search").click();
        }
      });
    });

    let tabMounted = false;
    function showTab(tab) {
      let targetTab = tab.getAttribute('data-target'),
        activeTabRank = parseInt(tab.parentNode.querySelector('.active').dataset.rank),
        currentTabRank = parseInt(tab.dataset.rank),
        currentBody = document.getElementById(tab.parentNode.querySelector('.active').dataset.target),
        targetBody = document.getElementById(targetTab),
        targetGroup = targetBody.dataset.tabGroup,
        tabGroupMembers = document.querySelectorAll(`[data-tab-group = '${targetGroup}']`),
        allTabs = tab.parentNode.querySelectorAll('.tab'),
        line = tab.parentNode.querySelector('.line')
      if (tabMounted && currentBody.isEqualNode(targetBody))
        return
      if (activeTabRank < currentTabRank) {
        targetBody.classList.add('fly-in-from-right')
        currentBody.classList.add('fly-out-to-left')
      }
      else {
        targetBody.classList.add('fly-in-from-left')
        currentBody.classList.add('fly-out-to-right')
      }
      setTimeout(() => {
        tabGroupMembers.forEach(member => {
          member.classList.add('hide-completely')
        })
        targetBody.classList.remove('hide-completely')
        currentBody.classList.remove('fly-out-to-right', 'fly-out-to-left')
      }, 200)
      setTimeout(() => {
        targetBody.classList.remove('fly-in-from-right', 'fly-in-from-left')
      }, 400)
      allTabs.forEach(thisTab => {
        thisTab.classList.remove('active')
      })
      tab.classList.add('active')
      line.setAttribute('style', `transform: translateX(${tab.offsetLeft}px); width: ${tab.getBoundingClientRect().width}px`)
      tabMounted = true;
    }

    let loader = document.getElementById("loader_page");

    function loading(status) {
      if (status) loader.classList.remove("hide-completely");
      else loader.classList.add("hide-completely");
    }

    function getBannerData() {
      return fetch(`${tokenapiUrl}/api/v1.0/getSystemData`)
        .then(function (response) {
          return response.json();
        })
        .then(function (systemdata) {
          let obj = {
            topToken: "RMT",
            totalTransactions: systemdata["systemTransactionCount"],
            walletAddresses: systemdata["systemAddressCount"],
            topContract: {
              name: "India Election 2019",
              address: 'F7osBpjDDV1mSSnMNrLudEQQ3cwDJ2dPR1'
            }
          };
          return obj;
        });
    }

    function getLatestTxs() {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getLatestTransactionDetails?numberOfLatestBlocks=4`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (latestTxs) {
          latestTxArray = [];

          let txids = Object.keys(latestTxs["latestTransactions"]);
          for (let i = 0; i < txids.length; i++) {
            // determine txhash and blockHeight
            let obj = {
              hash:
                latestTxs["latestTransactions"][txids[i]][
                "transactionDetails"
                ]["txid"],
              blockHeight:
                latestTxs["latestTransactions"][txids[i]][
                "transactionDetails"
                ]["blockheight"],
            };

            let txtype =
              latestTxs["latestTransactions"][txids[i]]["parsedFloData"][
              "type"
              ];

            if (txtype != "smartContractPays") {
              // determine token
              obj["token"] =
                latestTxs["latestTransactions"][txids[i]]["parsedFloData"][
                "tokenIdentification"
                ];

              if (txtype == "transfer") {
                if (
                  latestTxs["latestTransactions"][txids[i]]["parsedFloData"][
                  "transferType"
                  ] == "token"
                ) {
                  // token transfer
                  /* tokenTransferCard
                                                            hash, blockHeight, token, sender, receiver, amount */

                  let receiveraddress = "";
                  for (
                    let i = 0,
                    voutlist =
                      latestTxs["latestTransactions"][txids[i]][
                      "transactionDetails"
                      ]["vout"];
                    i < voutlist.length;
                    i++
                  ) {
                    if (
                      voutlist[i]["scriptPubKey"]["addresses"][0] !=
                      latestTxs["latestTransactions"][txids[i]][
                      "transactionDetails"
                      ]["vin"][0]["addr"]
                    ) {
                      receiveraddress =
                        voutlist[i]["scriptPubKey"]["addresses"][0];
                    }
                  }

                  obj = Object.assign({}, obj, {
                    sender:
                      latestTxs["latestTransactions"][txids[i]][
                      "transactionDetails"
                      ]["vin"][0]["addr"],
                    receiver: receiveraddress,
                    amount: `${
                      latestTxs["latestTransactions"][txids[i]][
                      "parsedFloData"
                      ]["tokenAmount"]
                      }`,
                    type: "tokentransfer",
                  });
                  latestTxArray.push(obj);
                } else if (
                  latestTxs["latestTransactions"][txids[i]]["parsedFloData"][
                  "transferType"
                  ] == "smartContract"
                ) {
                  // smart contract transfer
                  let receiveraddress = "";
                  for (
                    let i = 0,
                    voutlist =
                      latestTxs["latestTransactions"][txids[i]][
                      "transactionDetails"
                      ]["vout"];
                    i < voutlist.length;
                    i++
                  ) {
                    if (
                      voutlist[i]["scriptPubKey"]["addresses"][0] !=
                      latestTxs["latestTransactions"][txids[i]][
                      "transactionDetails"
                      ]["vin"][0]["addr"]
                    ) {
                      receiveraddress =
                        voutlist[i]["scriptPubKey"]["addresses"][0];
                    }
                  }

                  obj = Object.assign({}, obj, {
                    sender:
                      latestTxs["latestTransactions"][txids[i]][
                      "transactionDetails"
                      ]["vin"][0]["addr"],
                    receiver: receiveraddress,
                    amount: `${
                      latestTxs["latestTransactions"][txids[i]][
                      "parsedFloData"
                      ]["tokenAmount"]
                      }`,
                    contractName: `${
                      latestTxs["latestTransactions"][txids[i]][
                      "parsedFloData"
                      ]["contractName"]
                      }`,
                    userChoice: `${
                      latestTxs["latestTransactions"][txids[i]][
                      "parsedFloData"
                      ]["userChoice"]
                      }`,
                    type: "contracttransfer",
                  });
                  latestTxArray.push(obj);
                }
              } else if (
                latestTxs["latestTransactions"][txids[i]]["parsedFloData"][
                "type"
                ] == "smartContractIncorporation"
              ) {
                // smart contract incorporation
                // todo : add checks to determine obj for different types of smart contract incorporation
                obj = Object.assign({}, obj, {
                  contractName:
                    latestTxs["latestTransactions"][txids[i]][
                    "parsedFloData"
                    ]["contractName"],
                  incAddress:
                    latestTxs["latestTransactions"][txids[i]][
                    "parsedFloData"
                    ]["contractAddress"],
                  contractType:
                    latestTxs["latestTransactions"][txids[i]][
                    "parsedFloData"
                    ]["contractType"],
                  expiration:
                    latestTxs["latestTransactions"][txids[i]][
                    "parsedFloData"
                    ]["contractConditions"]["expiryTime"],
                  participationFees:
                    latestTxs["latestTransactions"][txids[i]][
                    "parsedFloData"
                    ]["contractConditions"]["contractAmount"],
                  availableChoices: "",
                  type: "contractincorp",
                });
                latestTxArray.push(obj);
              } else if (
                latestTxs["latestTransactions"][txids[i]]["parsedFloData"][
                "type"
                ] == "tokenIncorporation"
              ) {
                // token incorporation
                // smart contract incorporation
                obj = Object.assign({}, obj, {
                  incAddress:
                    latestTxs["latestTransactions"][txids[i]][
                    "transactionDetails"
                    ]["vin"][0]["addr"],
                  supply:
                    latestTxs["latestTransactions"][txids[i]][
                    "parsedFloData"
                    ]["tokenAmount"],
                  type: "tokenincorp",
                });
                latestTxArray.push(obj);
              }
            } else {
              // smart contract committee trigger
              // smart contract incorporation
              let receiveraddress = "";
              for (
                let i = 0,
                voutlist =
                  latestTxs["latestTransactions"][txids[i]][
                  "transactionDetails"
                  ]["vout"];
                i < voutlist.length;
                i++
              ) {
                if (
                  voutlist[i]["scriptPubKey"]["addresses"][0] !=
                  latestTxs["latestTransactions"][txids[i]][
                  "transactionDetails"
                  ]["vin"][0]["addr"]
                ) {
                  receiveraddress =
                    voutlist[i]["scriptPubKey"]["addresses"][0];
                }
              }
              obj = Object.assign({}, obj, {
                contractName:
                  latestTxs["latestTransactions"][txids[i]]["parsedFloData"][
                  "contractName"
                  ],
                contractAddress: receiveraddress,
                winningChoice:
                  latestTxs["latestTransactions"][txids[i]]["parsedFloData"][
                  "triggerCondition"
                  ],
                committeeAddress:
                  latestTxs["latestTransactions"][txids[i]][
                  "transactionDetails"
                  ]["vin"][0]["addr"],
                type: "contracttrigger",
              });
              latestTxArray.push(obj);
            }
          }

          return latestTxArray;
        });
    }

    function getLatestBlocks() {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getLatestBlockDetails?numberOfLatestBlocks=4`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (latestBlocks) {
          let obj = {};
          return obj;
        });
    }

    function getTokenInfo(thisToken) {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getTokenInfo?token=${thisToken.toLowerCase()}`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (tokenInfo) {
          let associatedSC = {};
          for (let i = 0, associatedScList = tokenInfo["associatedSmartContracts"]; i < associatedScList.length; i++) {
            associatedSC[`${associatedScList[i]["contractName"]}-${associatedScList[i]["contractAddress"]}`] = associatedScList[i];
          }
          let obj = {
            token: tokenInfo["token"],
            supply: tokenInfo["tokenSupply"],
            incAddress: tokenInfo["incorporationAddress"],
            associatedContracts: associatedSC,
            blockchainReference: tokenInfo["blockchainReference"],
          };
          return obj;
        });
    }

    async function getTokenBalances(tokenName) {
      const responce = await fetch(`${tokenapiUrl}/api/v1.0/getTokenBalances?token=` + tokenName),
            messeges = await responce.json()
      return messeges.balances
    }

    async function getTokenTransactions(tokenName) {
      const responce = await fetch(`${tokenapiUrl}/api/v1.0/getTokenTransactions?token=` + tokenName),
            transactions = await responce.json()
      return transactions.transactions

    }

    function getBlockInfo(thisBlock) {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getBlockDetails/${thisBlock}`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (blockInfo) {
          let obj = {
            blockHeight: blockInfo["blockDetails"]["height"],
            size: blockInfo["blockDetails"]["size"],
            transactions: "",
            reward: blockInfo["blockDetails"]["reward"],
            hash: blockInfo["blockDetails"]["hash"],
            difficulty: blockInfo["blockDetails"]["difficulty"],
            nonce: blockInfo["blockDetails"]["nonce"],
          };
          return obj;
        });
    }



    function getContractInfo(contract) {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getSmartContractInfo?contractName=${contract.name}&contractAddress=${contract.address}`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (contractInfo) {

          /*let obj = {
            blockHeight: blockInfo["height"],
            size: blockInfo["size"],
            transactions: "",
            reward: blockInfo["reward"],
            hash: blockInfo["hash"],
            difficulty: blockInfo["difficulty"],
            nonce: blockInfo["nonce"],
          }; */

          /* type 1
          expirytime	payeeaddress	minimumsubscriptionamount	maximumsubscriptionamount	contractamount

          // type 2
          expirytime	userchoices	contractamount	minimumsubscriptionamount	maximumsubscriptionamount
          */

          return obj = {};
        });
    }

    function getContractParticipants(contract) {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getSmartContractParticipants?contractName=${contract.name}&contractAddress=${contract.address}`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (contractParticipants) {
          /*let obj = {
            blockHeight: blockInfo["height"],
            size: blockInfo["size"],
            transactions: "",
            reward: blockInfo["reward"],
            hash: blockInfo["hash"],
            difficulty: blockInfo["difficulty"],
            nonce: blockInfo["nonce"],
          };*/
          return obj = {};
        });
    }

    function getContractTransactions(contract) {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getSmartContractTransactions?contractName=${contract.name}&contractAddress=${contract.address}`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (contractTxs) {
          /*let obj = {
            blockHeight: blockInfo["height"],
            size: blockInfo["size"],
            transactions: "",
            reward: blockInfo["reward"],
            hash: blockInfo["hash"],
            difficulty: blockInfo["difficulty"],
            nonce: blockInfo["nonce"],
          };*/
          return obj = {};
        });
    }

    function getViewallBlocks() {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getLatestBlockDetails?limit=100`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (contractTxs) {
          debugger;
          /*let obj = {
            blockHeight: blockInfo["height"],
            size: blockInfo["size"],
            transactions: "",
            reward: blockInfo["reward"],
            hash: blockInfo["hash"],
            difficulty: blockInfo["difficulty"],
            nonce: blockInfo["nonce"],
          }; */
          return obj;
        });
    }

    function getViewallTxs() {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getLatestTransactionDetails?limit=200`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (contractTxs) {
          let obj = {
            blockHeight: blockInfo["height"],
            size: blockInfo["size"],
            transactions: "",
            reward: blockInfo["reward"],
            hash: blockInfo["hash"],
            difficulty: blockInfo["difficulty"],
            nonce: blockInfo["nonce"],
          };
          return obj;
        });
    }

    function getAddressInfo(floAddress) {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getFloAddressInfo?floAddress=${floAddress}`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (addressInfo) {
          // tokens
          if (typeof addressInfo["floAddressBalances"] === "undefined") {
            for (
              let i = 0,
              tokenkeys = Object.keys(addressInfo["floAddressBalances"]);
              i < tokenkeys.length;
              i++
            ) { }
          }

          // contracts
          if (typeof addressInfo["incorporatedSmartContracts"] === "undefined") {
            for (let i = 0,
              contractkeys = Object.keys(
                addressInfo["incorporatedSmartContracts"]
              );
              i < contractkeys.length;
              i++
            ) { }
          }

          /*let obj = {
            blockHeight: blockInfo["height"],
            size: blockInfo["size"],
            transactions: "",
            reward: blockInfo["reward"],
            hash: blockInfo["hash"],
            difficulty: blockInfo["difficulty"],
            nonce: blockInfo["nonce"],
          };*/
          return (obj = {});
        });
    }

    async function getAddressBalance(floAddress) {
      const responce =  await fetch(`${floapiUrl}/api/addr/${floAddress}/balance`),
            balance = await responce.json()
      return balance;
    }

    function getAddressTxs(floAddress) {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getFloAddressTransactions?floAddress=${floAddress}`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (addressTxs) {
          /*
          let obj = {
            blockHeight: blockInfo["height"],
            size: blockInfo["size"],
            transactions: "",
            reward: blockInfo["reward"],
            hash: blockInfo["hash"],
            difficulty: blockInfo["difficulty"],
            nonce: blockInfo["nonce"],
          };
          */
          return (obj = {});
        });
    }

    function getTxInfo(thisTx) {
      return fetch(
        `${tokenapiUrl}/api/v1.0/getTransactionDetails/${thisTx}`
      )
        .then(function (response) {
          return response.json();
        })
        .then(function (txDetails) {
          debugger;
          let obj = {
            blockHeight: blockInfo["blockDetails"]["height"],
            size: blockInfo["blockDetails"]["size"],
            transactions: "",
            reward: blockInfo["blockDetails"]["reward"],
            hash: blockInfo["blockDetails"]["hash"],
            difficulty: blockInfo["blockDetails"]["difficulty"],
            nonce: blockInfo["blockDetails"]["nonce"],
          };
          return obj;
        });
    }

  </script>
  
<!-- Set urls for token and flo Apis -->
<script>
  window.tokenapiUrl = 'https://ranchimallflo.duckdns.org'
  window.floapiUrl = 'https://flosight.duckdns.org'
</script>

<!-- Flex search content -->
<script>
  /*
   FlexSearch v0.6.22
   Copyright 2019 Nextapps GmbH
   Author: Thomas Wilkerling
   Released under the Apache 2.0 Licence
   https://github.com/nextapps-de/flexsearch
  */
  //FlexSearch min mode
  DEBUG = true;
  'use strict'; (function (I, R, v) { let K; (K = v.define) && K.amd ? K([], function () { return R }) : (K = v.modules) ? K[I.toLowerCase()] = R : "object" === typeof exports ? module.exports = R : v[I] = R })("FlexSearch", function ma(I) {
    function v(a, b) { const c = b ? b.id : a && a.id; this.id = c || 0 === c ? c : na++; this.init(a, b); fa(this, "index", function () { return this.a ? Object.keys(this.a.index[this.a.keys[0]].c) : Object.keys(this.c) }); fa(this, "length", function () { return this.index.length }) } function K(a, b, c, d) {
      this.u !== this.g && (this.o = this.o.concat(c), this.u++,
        d && this.o.length >= d && (this.u = this.g), this.u === this.g && (this.cache && this.l.set(b, this.o), this.F && this.F(this.o))); return this
    } function S(a) { const b = B(); for (const c in a) if (a.hasOwnProperty(c)) { const d = a[c]; b[c] = E(d) ? d.slice(0) : J(d) ? S(d) : d } return b } function W(a, b) { const c = a.length, d = O(b), e = []; for (let f = 0, g = 0; f < c; f++) { const h = a[f]; if (d && b(h) || !d && !b[h]) e[g++] = h } return e } function P(a, b, c, d, e, f, g, h, l, m) {
      c = ha(c, g ? 0 : e, h, f, b, l, m); let n; h && (h = c.page, n = c.next, c = c.result); if (g) b = this.where(g, null, e, c); else {
        b =
          c; c = this.h; e = b.length; f = Array(e); for (g = 0; g < e; g++)f[g] = c[b[g]]; b = f
      } c = b; d && (O(d) || (L = d.split(":"), 1 < L.length ? d = oa : (L = L[0], d = pa)), c.sort(d)); c = T(h, n, c); this.cache && this.l.set(a, c); return c
    } function fa(a, b, c) { Object.defineProperty(a, b, { get: c }) } function q(a) { return new RegExp(a, "g") } function Q(a, b) { for (let c = 0; c < b.length; c += 2)a = a.replace(b[c], b[c + 1]); return a } function V(a, b, c, d, e, f, g, h) {
      if (b[c]) return b[c]; e = e ? (h - (g || h / 1.5)) * f + (g || h / 1.5) * e : f; b[c] = e; e >= g && (a = a[h - (e + .5 >> 0)], a = a[c] || (a[c] = []), a[a.length] =
        d); return e
    } function ba(a, b) { if (a) { const c = Object.keys(a); for (let d = 0, e = c.length; d < e; d++) { const f = c[d], g = a[f]; if (g) for (let h = 0, l = g.length; h < l; h++)if (g[h] === b) { 1 === l ? delete a[f] : g.splice(h, 1); break } else J(g[h]) && ba(g[h], b) } } } function ca(a) { let b = "", c = ""; var d = ""; for (let e = 0; e < a.length; e++) { const f = a[e]; if (f !== c) if (e && "h" === f) { if (d = "a" === d || "e" === d || "i" === d || "o" === d || "u" === d || "y" === d, ("a" === c || "e" === c || "i" === c || "o" === c || "u" === c || "y" === c) && d || " " === c) b += f } else b += f; d = e === a.length - 1 ? "" : a[e + 1]; c = f } return b }
    function qa(a, b) { a = a.length - b.length; return 0 > a ? 1 : a ? -1 : 0 } function pa(a, b) { a = a[L]; b = b[L]; return a < b ? -1 : a > b ? 1 : 0 } function oa(a, b) { const c = L.length; for (let d = 0; d < c; d++)a = a[L[d]], b = b[L[d]]; return a < b ? -1 : a > b ? 1 : 0 } function T(a, b, c) { return a ? { page: a, next: b ? "" + b : null, result: c } : c } function ha(a, b, c, d, e, f, g) {
      let h, l = []; if (!0 === c) { c = "0"; var m = "" } else m = c && c.split(":"); const n = a.length; if (1 < n) {
        const y = B(), r = []; let w, x; var p = 0, k; let G; var u = !0; let C, D = 0, N, da, X, ea; m && (2 === m.length ? (X = m, m = !1) : m = ea = parseInt(m[0], 10));
        if (g) { for (w = B(); p < n; p++)if ("not" === e[p]) for (x = a[p], G = x.length, k = 0; k < G; k++)w["@" + x[k]] = 1; else da = p + 1; if (H(da)) return T(c, h, l); p = 0 } else N = M(e) && e; let Y; for (; p < n; p++) {
          const ra = p === (da || n) - 1; if (!N || !p) if ((k = N || e && e[p]) && "and" !== k) if ("or" === k) Y = !1; else continue; else Y = f = !0; x = a[p]; if (G = x.length) {
            if (u) if (C) { var t = C.length; for (k = 0; k < t; k++) { u = C[k]; var A = "@" + u; g && w[A] || (y[A] = 1, f || (l[D++] = u)) } C = null; u = !1 } else { C = x; continue } A = !1; for (k = 0; k < G; k++) {
              t = x[k]; var z = "@" + t; const Z = f ? y[z] || 0 : p; if (!(!Z && !d || g && w[z] || !f &&
                y[z])) if (Z === p) { if (ra) { if (!ea || --ea < D) if (l[D++] = t, b && D === b) return T(c, D + (m || 0), l) } else y[z] = p + 1; A = !0 } else d && (z = r[Z] || (r[Z] = []), z[z.length] = t)
            } if (Y && !A && !d) break
          } else if (Y && !d) return T(c, h, x)
        } if (C) if (p = C.length, g) for (k = m ? parseInt(m, 10) : 0; k < p; k++)a = C[k], w["@" + a] || (l[D++] = a); else l = C; if (d) for (D = l.length, X ? (p = parseInt(X[0], 10) + 1, k = parseInt(X[1], 10) + 1) : (p = r.length, k = 0); p--;)if (t = r[p]) { for (G = t.length; k < G; k++)if (d = t[k], !g || !w["@" + d]) if (l[D++] = d, b && D === b) return T(c, p + ":" + k, l); k = 0 }
      } else !n || e && "not" === e[0] ||
        (l = a[0], m && (m = parseInt(m[0], 10))); b && (g = l.length, m && m > g && (m = 0), m = m || 0, h = m + b, h < g ? l = l.slice(m, h) : (h = 0, m && (l = l.slice(m)))); return T(c, h, l)
    } function M(a) { return "string" === typeof a } function E(a) { return a.constructor === Array } function O(a) { return "function" === typeof a } function J(a) { return "object" === typeof a } function H(a) { return "undefined" === typeof a } function ia(a) { const b = Array(a); for (let c = 0; c < a; c++)b[c] = B(); return b } function B() { return Object.create(null) } function sa() {
      let a, b; self.onmessage = function (c) {
        if (c =
          c.data) if (c.search) { const d = b.search(c.content, c.threshold ? { limit: c.limit, threshold: c.threshold, where: c.where } : c.limit); self.postMessage({ id: a, content: c.content, limit: c.limit, result: d }) } else c.add ? b.add(c.id, c.content) : c.update ? b.update(c.id, c.content) : c.remove ? b.remove(c.id) : c.clear ? b.clear() : c.info ? (c = b.info(), c.worker = a, console.log(c)) : c.register && (a = c.id, c.options.cache = !1, c.options.async = !1, c.options.worker = !1, b = (new Function(c.register.substring(c.register.indexOf("{") + 1, c.register.lastIndexOf("}"))))(),
            b = new b(c.options))
      }
    } function ta(a, b, c, d) { a = I("flexsearch", "id" + a, sa, function (f) { (f = f.data) && f.result && d(f.id, f.content, f.result, f.limit, f.where, f.cursor, f.suggest) }, b); const e = ma.toString(); c.id = b; a.postMessage({ register: e, options: c, id: b }); return a } const F = { encode: "icase", f: "forward", split: /\W+/, cache: !1, async: !1, g: !1, D: !1, a: !1, b: 9, threshold: 0, depth: 0 }, ja = {
      memory: { encode: "extra", f: "strict", threshold: 0, b: 1 }, speed: { encode: "icase", f: "strict", threshold: 1, b: 3, depth: 2 }, match: {
        encode: "extra", f: "full", threshold: 1,
        b: 3
      }, score: { encode: "extra", f: "strict", threshold: 1, b: 9, depth: 4 }, balance: { encode: "balance", f: "strict", threshold: 0, b: 3, depth: 3 }, fast: { encode: "icase", f: "strict", threshold: 8, b: 9, depth: 1 }
    }, aa = []; let na = 0; const ka = {}, la = {}; v.create = function (a, b) { return new v(a, b) }; v.registerMatcher = function (a) { for (const b in a) a.hasOwnProperty(b) && aa.push(q(b), a[b]); return this }; v.registerEncoder = function (a, b) { U[a] = b.bind(U); return this }; v.registerLanguage = function (a, b) { ka[a] = b.filter; la[a] = b.stemmer; return this }; v.encode =
      function (a, b) { return U[a](b) }; v.prototype.init = function (a, b) {
        this.v = []; if (b) { var c = b.preset; a = b } else a || (a = F), c = a.preset; b = {}; M(a) ? (b = ja[a], a = {}) : c && (b = ja[c]); if (c = a.worker) if ("undefined" === typeof Worker) a.worker = !1, this.m = null; else { var d = parseInt(c, 10) || 4; this.C = -1; this.u = 0; this.o = []; this.F = null; this.m = Array(d); for (var e = 0; e < d; e++)this.m[e] = ta(this.id, e, a, K.bind(this)) } this.f = a.tokenize || b.f || this.f || F.f; this.split = a.split || this.split || F.split; this.D = a.rtl || this.D || F.D; this.async = "undefined" === typeof Promise ||
          H(c = a.async) ? this.async || F.async : c; this.g = H(c = a.worker) ? this.g || F.g : c; this.threshold = H(c = a.threshold) ? b.threshold || this.threshold || F.threshold : c; this.b = H(c = a.resolution) ? c = b.b || this.b || F.b : c; c <= this.threshold && (this.b = this.threshold + 1); this.depth = "strict" !== this.f || H(c = a.depth) ? b.depth || this.depth || F.depth : c; this.w = (c = H(c = a.encode) ? b.encode || F.encode : c) && U[c] && U[c].bind(U) || (O(c) ? c : this.w || !1); (c = a.matcher) && this.addMatcher(c); if (c = (b = a.lang) || a.filter) {
            M(c) && (c = ka[c]); if (E(c)) {
              d = this.w; e = B(); for (var f =
                0; f < c.length; f++) { var g = d ? d(c[f]) : c[f]; e[g] = 1 } c = e
            } this.filter = c
          } if (c = b || a.stemmer) { var h; b = M(c) ? la[c] : c; d = this.w; e = []; for (h in b) b.hasOwnProperty(h) && (f = d ? d(h) : h, e.push(q(f + "($|\\W)"), d ? d(b[h]) : b[h])); this.stemmer = h = e } this.a = e = (c = a.doc) ? S(c) : this.a || F.a; this.j = ia(this.b - (this.threshold || 0)); this.i = B(); this.c = B(); if (e) {
            this.h = B(); a.doc = null; h = e.index = {}; b = e.keys = []; d = e.field; f = e.tag; E(e.id) || (e.id = e.id.split(":")); if (f) {
              this.G = B(); g = B(); if (d) if (M(d)) g[d] = a; else if (E(d)) for (let l = 0; l < d.length; l++)g[d[l]] =
                a; else J(d) && (g = d); E(f) || (e.tag = f = [f]); for (d = 0; d < f.length; d++)this.G[f[d]] = B(); this.I = f; d = g
            } if (d) { let l; E(d) || (J(d) ? (l = d, e.field = d = Object.keys(d)) : e.field = d = [d]); for (e = 0; e < d.length; e++)f = d[e], E(f) || (l && (a = l[f]), b[e] = f, d[e] = f.split(":")), h[f] = new v(a), h[f].h = this.h }
          } this.B = !0; this.l = (this.cache = c = H(c = a.cache) ? this.cache || F.cache : c) ? new ua(c) : !1; return this
      }; v.prototype.encode = function (a) {
        a && aa.length && (a = Q(a, aa)); a && this.v.length && (a = Q(a, this.v)); a && this.w && (a = this.w(a)); a && this.stemmer && (a = Q(a, this.stemmer));
        return a
      }; v.prototype.addMatcher = function (a) { const b = this.v; for (const c in a) a.hasOwnProperty(c) && b.push(q(c), a[c]); return this }; v.prototype.add = function (a, b, c, d, e) {
        if (this.a && J(a)) return this.A("add", a, b); if (b && M(b) && (a || 0 === a)) {
          var f = "@" + a; if (this.c[f] && !d) return this.update(a, b); if (this.g) return ++this.C >= this.m.length && (this.C = 0), this.m[this.C].postMessage({ add: !0, id: a, content: b }), this.c[f] = "" + this.C, c && c(), this; if (!e) {
            if (this.async && "function" !== typeof importScripts) {
              let r = this; f = new Promise(function (w) {
                setTimeout(function () {
                  r.add(a,
                    b, null, d, !0); r = null; w()
                })
              }); if (c) f.then(c); else return f; return this
            } if (c) return this.add(a, b, null, d, !0), c(), this
          } b = this.encode(b); if (!b.length) return this; c = this.f; e = O(c) ? c(b) : b.split(this.split); this.filter && (e = W(e, this.filter)); const p = B(); p._ctx = B(); const k = e.length, u = this.threshold, t = this.depth, A = this.b, z = this.j, y = this.D; for (let r = 0; r < k; r++) {
            var g = e[r]; if (g) {
              var h = g.length, l = (y ? r + 1 : k - r) / k, m = ""; switch (c) {
                case "reverse": case "both": for (var n = h; --n;)m = g[n] + m, V(z, p, m, a, y ? 1 : (h - n) / h, l, u, A - 1); m = "";
                case "forward": for (n = 0; n < h; n++)m += g[n], V(z, p, m, a, y ? (n + 1) / h : 1, l, u, A - 1); break; case "full": for (n = 0; n < h; n++) { const w = (y ? n + 1 : h - n) / h; for (let x = h; x > n; x--)m = g.substring(n, x), V(z, p, m, a, w, l, u, A - 1) } break; default: if (h = V(z, p, g, a, 1, l, u, A - 1), t && 1 < k && h >= u) for (h = p._ctx[g] || (p._ctx[g] = B()), g = this.i[g] || (this.i[g] = ia(A - (u || 0))), l = r - t, m = r + t + 1, 0 > l && (l = 0), m > k && (m = k); l < m; l++)l !== r && V(g, h, e[l], a, 0, A - (l < r ? r - l : l - r), u, A - 1)
              }
            }
          } this.c[f] = 1; this.B = !1
        } return this
      }; v.prototype.A = function (a, b, c) {
        if (E(b)) for (let l = 0, m = b.length; l < m; l++) {
          if (l ===
            m - 1) return this.A(a, b[l], c); this.A(a, b[l])
        } else {
          const l = this.a.index, m = this.a.keys; var d = this.a.tag, e = this.a.id; let n; let p; for (var f = 0; f < e.length; f++)n = (n || b)[e[f]]; if (d) { for (e = 0; e < d.length; e++) { var g = d[e]; var h = g.split(":"); for (f = 0; f < h.length; f++)p = (p || b)[h[f]]; p = "@" + p } h = this.G[g]; h = h[p] || (h[p] = []) } if ("remove" === a) { delete this.h[n]; for (let k = 0, u = m.length; k < u; k++) { if (k === u - 1) return l[m[k]].remove(n, c), this; l[m[k]].remove(n) } } e = this.a.field; h && (h[h.length] = b); this.h[n] = b; for (let k = 0, u = e.length; k <
            u; k++) { d = e[k]; let t; for (g = 0; g < d.length; g++)t = (t || b)[d[g]]; d = l[m[k]]; g = "add" === a ? d.add : d.update; k === u - 1 ? g.call(d, n, t, c) : g.call(d, n, t) }
        } return this
      }; v.prototype.update = function (a, b, c) { if (this.a && J(a)) return this.A("update", a, b); this.c["@" + a] && M(b) && (this.remove(a), this.add(a, b, c, !0)); return this }; v.prototype.remove = function (a, b, c) {
        if (this.a && J(a)) return this.A("remove", a, b); var d = "@" + a; if (this.c[d]) {
          if (this.g) return this.m[this.c[d]].postMessage({ remove: !0, id: a }), delete this.c[d], b && b(), this; if (!c) {
            if (this.async &&
              "function" !== typeof importScripts) { let e = this; d = new Promise(function (f) { setTimeout(function () { e.remove(a, null, !0); e = null; f() }) }); if (b) d.then(b); else return d; return this } if (b) return this.remove(a, null, !0), b(), this
          } for (b = 0; b < this.b - (this.threshold || 0); b++)ba(this.j[b], a); this.depth && ba(this.i, a); delete this.c[d]; this.B = !1
        } return this
      }; let L; v.prototype.search = function (a, b, c, d) {
        if (J(b)) { if (E(b)) for (var e = 0; e < b.length; e++)b[e].query = a; else b.query = a; a = b; b = 1E3 } else b && O(b) ? (c = b, b = 1E3) : b || 0 === b || (b = 1E3);
        let f = [], g = a; let h, l, m; if (J(a) && !E(a)) { c || (c = a.callback) && (g.callback = null); l = a.sort; h = a.page; b = a.limit; var n = a.threshold; m = a.suggest; a = a.query } if (this.a) {
          n = this.a.index; const y = g.where; var p = g.bool || "or", k = g.field; let r = p; let w, x; if (k) E(k) || (k = [k]); else if (E(g)) { var u = g; k = []; r = []; for (var t = 0; t < g.length; t++)d = g[t], e = d.bool || p, k[t] = d.field, r[t] = e, "not" === e ? w = !0 : "and" === e && (x = !0) } else k = this.a.keys; p = k.length; for (t = 0; t < p; t++)u && (g = u[t]), h && !M(g) && (g.page = null, g.limit = 0), f[t] = n[k[t]].search(g, 0); if (this.g) {
            this.F =
              c; this.u = 0; this.o = []; for (n = 0; n < this.g; n++)this.m[n].postMessage({ search: !0, limit: b, content: g }); return
          } if (c) return c(P.call(this, a, r, f, l, b, m, y, h, x, w)); if (this.async) { const G = this; return new Promise(function (C) { Promise.all(f).then(function (D) { C(P.call(G, a, r, D, l, b, m, y, h, x, w)) }) }) } return P.call(this, a, r, f, l, b, m, y, h, x, w)
        } n || (n = this.threshold || 0); if (!d) {
          if (this.async && "function" !== typeof importScripts) {
            let y = this; n = new Promise(function (r) { setTimeout(function () { r(y.search(g, b, null, !0)); y = null }) }); if (c) n.then(c);
            else return n; return this
          } if (c) return c(this.search(g, b, null, !0)), this
        } if (!a || !M(a)) return f; g = a; if (this.cache) if (this.B) { if (c = this.l.get(a)) return c } else this.l.clear(), this.B = !0; g = this.encode(g); if (!g.length) return f; c = this.f; c = O(c) ? c(g) : g.split(this.split); this.filter && (c = W(c, this.filter)); u = c.length; d = !0; e = []; const A = B(); let z = 0; 1 < u && (this.depth && "strict" === this.f ? p = !0 : c.sort(qa)); if (!p || (t = this.i)) {
          const y = this.b; for (; z < u; z++) {
            let r = c[z]; if (r) {
              if (p) {
                if (!k) if (t[r]) k = r, A[r] = 1; else if (!m) return f;
                if (m && z === u - 1 && !e.length) p = !1, r = k || r, A[r] = 0; else if (!k) continue
              } if (!A[r]) { const w = []; let x = !1, G = 0; const C = p ? t[k] : this.j; if (C) { let D; for (let N = 0; N < y - n; N++)if (D = C[N] && C[N][r]) w[G++] = D, x = !0 } if (x) k = r, e[e.length] = 1 < G ? w.concat.apply([], w) : w[0]; else if (!m) { d = !1; break } A[r] = 1 }
            }
          }
        } else d = !1; d && (f = ha(e, b, h, m)); this.cache && this.l.set(a, f); return f
      }; v.prototype.find = function (a, b) { return this.where(a, b, 1)[0] || null }; v.prototype.where = function (a, b, c, d) {
        const e = this.h, f = []; let g = 0; let h; var l; let m; if (J(a)) {
          c || (c =
            b); var n = Object.keys(a); var p = n.length; h = !1; if (1 === p && "id" === n[0]) return [e[a.id]]; if ((l = this.I) && !d) for (var k = 0; k < l.length; k++) { var u = l[k], t = a[u]; if (!H(t)) { m = this.G[u]["@" + t]; if (0 === --p) return m; n.splice(n.indexOf(u), 1); delete a[u]; break } } l = Array(p); for (k = 0; k < p; k++)l[k] = n[k].split(":")
        } else { if (O(a)) { b = d || Object.keys(e); c = b.length; for (n = 0; n < c; n++)p = e[b[n]], a(p) && (f[g++] = p); return f } if (H(b)) return [e[a]]; if ("id" === a) return [e[b]]; n = [a]; p = 1; l = [a.split(":")]; h = !0 } d = m || d || Object.keys(e); k = d.length; for (u =
          0; u < k; u++) { t = m ? d[u] : e[d[u]]; let A = !0; for (let z = 0; z < p; z++) { h || (b = a[n[z]]); const y = l[z], r = y.length; let w = t; if (1 < r) for (let x = 0; x < r; x++)w = w[y[x]]; else w = w[y[0]]; if (w !== b) { A = !1; break } } if (A && (f[g++] = t, c && g === c)) break } return f
      }; v.prototype.info = function () {
        if (this.g) for (let a = 0; a < this.g; a++)this.m[a].postMessage({ info: !0, id: this.id }); else return {
          id: this.id, items: this.length, cache: this.cache && this.cache.s ? this.cache.s.length : !1, matcher: aa.length + (this.v ? this.v.length : 0), worker: this.g, threshold: this.threshold,
          depth: this.depth, resolution: this.b, contextual: this.depth && "strict" === this.f
        }
      }; v.prototype.clear = function () { return this.destroy().init() }; v.prototype.destroy = function () { this.cache && (this.l.clear(), this.l = null); this.j = this.i = this.c = null; if (this.a) { const a = this.a.keys; for (let b = 0; b < a.length; b++)this.a.index[a[b]].destroy(); this.a = this.h = null } return this }; v.prototype.export = function () {
        let a; if (this.a) {
          const b = this.a.keys; a = Array(b.length + 1); let c = 0; for (; c < b.length; c++) {
            const d = this.a.index[b[c]]; a[c] =
              [d.j, d.i, Object.keys(d.c)]
          } a[c] = this.h
        } else a = [this.j, this.i, Object.keys(this.c)]; return JSON.stringify(a)
      }; v.prototype.import = function (a) { a = JSON.parse(a); const b = B(); if (this.a) { var c = this.a.keys, d = c.length, e = a[0][2]; for (var f = 0; f < e.length; f++)b[e[f]] = 1; for (e = 0; e < d; e++)f = this.a.index[c[e]], f.j = a[e][0], f.i = a[e][1], f.c = b, f.h = a[d]; this.h = a[d] } else { c = a[2]; for (d = 0; d < c.length; d++)b[c[d]] = 1; this.j = a[0]; this.i = a[1]; this.c = b } }; const U = {
        icase: function (a) { return a.toLowerCase() }, simple: function () {
          const a = [q("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]"),
            "a", q("[\u00e8\u00e9\u00ea\u00eb]"), "e", q("[\u00ec\u00ed\u00ee\u00ef]"), "i", q("[\u00f2\u00f3\u00f4\u00f5\u00f6\u0151]"), "o", q("[\u00f9\u00fa\u00fb\u00fc\u0171]"), "u", q("[\u00fd\u0177\u00ff]"), "y", q("\u00f1"), "n", q("[\u00e7c]"), "k", q("\u00df"), "s", q(" & "), " and ", q("[-/]"), " ", q("[^a-z0-9 ]"), "", q("\\s+"), " "]; return function (b) { b = Q(b.toLowerCase(), a); return " " === b ? "" : b }
        }(), advanced: function () {
          const a = [q("ae"), "a", q("ai"), "ei", q("ay"), "ei", q("ey"), "ei", q("oe"), "o", q("ue"), "u", q("ie"), "i", q("sz"),
            "s", q("zs"), "s", q("sh"), "s", q("ck"), "k", q("cc"), "k", q("th"), "t", q("dt"), "t", q("ph"), "f", q("pf"), "f", q("ou"), "o", q("uo"), "u"]; return function (b, c) { if (!b) return b; b = this.simple(b); 2 < b.length && (b = Q(b, a)); c || 1 < b.length && (b = ca(b)); return b }
        }(), extra: function () {
          const a = [q("p"), "b", q("z"), "s", q("[cgq]"), "k", q("n"), "m", q("d"), "t", q("[vw]"), "f", q("[aeiouy]"), ""]; return function (b) {
            if (!b) return b; b = this.advanced(b, !0); if (1 < b.length) {
              b = b.split(" "); for (let c = 0; c < b.length; c++) {
                const d = b[c]; 1 < d.length && (b[c] =
                  d[0] + Q(d.substring(1), a))
              } b = b.join(" "); b = ca(b)
            } return b
          }
        }(), balance: function () { const a = [q("[-/]"), " ", q("[^a-z0-9 ]"), "", q("\\s+"), " "]; return function (b) { return ca(Q(b.toLowerCase(), a)) } }()
      }, ua = function () {
        function a(b) { this.clear(); this.H = !0 !== b && b } a.prototype.clear = function () { this.cache = B(); this.count = B(); this.index = B(); this.s = [] }; a.prototype.set = function (b, c) {
          if (this.H && H(this.cache[b])) {
            let d = this.s.length; if (d === this.H) { d--; const e = this.s[d]; delete this.cache[e]; delete this.count[e]; delete this.index[e] } this.index[b] =
              d; this.s[d] = b; this.count[b] = -1; this.cache[b] = c; this.get(b)
          } else this.cache[b] = c
        }; a.prototype.get = function (b) { const c = this.cache[b]; if (this.H && c) { var d = ++this.count[b]; const f = this.index; let g = f[b]; if (0 < g) { const h = this.s; for (var e = g; this.count[h[--g]] <= d && -1 !== g;); g++; if (g !== e) { for (d = e; d > g; d--)e = h[d - 1], h[d] = e, f[e] = d; h[g] = b; f[b] = g } } } return c }; return a
      }(); return v
  }(function () {
    const I = {}, R = "undefined" !== typeof Blob && "undefined" !== typeof URL && URL.createObjectURL; return function (v, K, S, W, P) {
      S = R ? URL.createObjectURL(new Blob(["(" +
        S.toString() + ")()"], { type: "text/javascript" })) : v + ".min.js"; v += "-" + K; I[v] || (I[v] = []); I[v][P] = new Worker(S); I[v][P].onmessage = W; return I[v][P]
    }
  }()), this);
</script>

  <!-- Navbar functionality -->
  <script>

    // THIS TAG CONTAINS CODE REQUIRED FOR THE NAVBAR TO FUNCTION
    function returnHexaNumber(s) {
      var regExp = /^[-+]?[0-9A-Fa-f]+\.?[0-9A-Fa-f]*?$/;
      return (typeof s === 'string' && regExp.test(s));
    }

    function isInt(n) {
      return Number(n) === n && n % 1 === 0;
    }

    function isFloat(n) {
      return Number(n) === n && n % 1 !== 0;
    }

    function splitContractNameAddress(value, index) {
      var tempArray = [];
      tempArray[0] = value.substring(0, index);
      tempArray[1] = value.substring(index + 1);
      return tempArray
    }

    function categoriseText(text, inputElement) {

      if (!isNaN(text) && isInt(Number(text))) {
        //console.log('this is a block number');
        inputElement.value = '';
        render("block_page", text);
        appState = {
          page: "block_page",
          thisField: text,
        }
        history.pushState(appState, null, null)
      }
      else if (typeof (text) == 'string') {
        if (text.length == 34 && text[0] == 'F') {
          //console.log('data entered in a FLO address');
          inputElement.value = '';
          render("address_page", text)
          appState = {
            page: "address_page",
            thisField: text,
          }
          history.pushState(appState, null, null)
        }
        else if (window.ranchimallflo.tokenlist.includes(text)) {
          //console.log('data entered is a token name');
          inputElement.value = '';
          render("token_page", text)
          appState = {
            page: "token_page",
            thisField: text,
          }
          history.pushState(appState, null, null)
        }
        else if (window.ranchimallflo.smartcontractnamelist.includes(text)) {
          //console.log('data entered is a smart contract name');
          for (var i = 0; i < window.ranchimallflo.smartcontractnameaddresslist.length; i++) {

            var contractSplit = splitContractNameAddress(window.ranchimallflo.smartcontractnameaddresslist[i], window.ranchimallflo.smartcontractnameaddresslist[i].lastIndexOf('-'));

            if (window.ranchimallflo.smartcontractnamelist.includes(text)) {
              inputElement.value = '';
              render("address_page", contract={name:'',
                                               address: ''})
              appState = {
                page: "address_page",
                thisField: text,
              }
              history.pushState(appState, null, null)
            }
          }

        }
        else if (text.length == 64 && returnHexaNumber(text)) {

          fetch(`${window.tokenapiUrl}/api/v1.0/categoriseString/` + text)
            .then(function (response) {
              return response.json();
            })
            .then(function (myJson) {
              if (myJson['type'] == 'transaction') {
                //console.log('data entered is a transaction hash');
                inputElement.value = '';
                render("transaction_page", text);
                appState = {
                  page: "transaction_page",
                  thisField: text,
                }
                history.pushState(appState, null, null)
              }
              else if (myJson['type'] == 'block') {
                //console.log('data entered is a block hash');
                inputElement.value = '';
                render("block_page", text)
                appState = {
                  page: "block_page",
                  thisField: text,
                }
                history.pushState(appState, null, null)
              }
              else {
                //console.log('data entered is noise');
              }
            });

        }
        else {
          //console.log('data entered is noise')
        }

        //document.getElementById('main-search-text').value = '';
      }
    }

    function processNavbarSearch() {
      userinput = document.getElementById('main-search-text');
      console.log(userinput.value);
    
      if (userinput.value != '') {
        categoriseText(userinput.value, userinput);
      }
    }

    function runScriptJs() {
      var $cell = $('.card');

      //open and close card when clicked on card
      $cell.find('.js-expander').click(function () {

        var $thisCell = $(this).closest('.card');

        if ($thisCell.hasClass('is-collapsed')) {
          $cell.not($thisCell).removeClass('is-expanded').addClass('is-collapsed').addClass('is-inactive');
          $thisCell.removeClass('is-collapsed').addClass('is-expanded');

          if ($cell.not($thisCell).hasClass('is-inactive')) {
            //do nothing
          } else {
            $cell.not($thisCell).addClass('is-inactive');
          }

        } else {
          $thisCell.removeClass('is-expanded').addClass('is-collapsed');
          $cell.not($thisCell).removeClass('is-inactive');
        }
      });

      //close card when click on cross
      $cell.find('.js-collapser').click(function () {

        var $thisCell = $(this).closest('.card');

        $thisCell.removeClass('is-expanded').addClass('is-collapsed');
        $cell.not($thisCell).removeClass('is-inactive');

      });
    }


    // First load
    // console.log('Cursor right before the first fetch call');

    // loading of global variables which contains name of all tokens and smart contracts

    var data = [];
    fetch(`${window.tokenapiUrl}/api/v1.0/getTokenSmartContractList`)
      .then(function (response) {
        return response.json();
      })
      .then(function (myJson) {

        //console.log('first line of the fetch result');

        window.ranchimallflo = {};
        ranchimallflo.tokenlist = myJson['tokens'];
        ranchimallflo.smartcontractlist = myJson['smartContracts'];
        ranchimallflo.smartcontractnamelist = [];
        ranchimallflo.smartcontractnameaddresslist = [];
        //console.log(ranchimallflo.smartcontractlist.length);
        for (var i = 0; i < ranchimallflo.smartcontractlist.length; i++) {
          //ranchimallflo.smartcontractnamelist.append(ranchimallflo.smartcontractlist[i]['contractName']);
          data.push(ranchimallflo.smartcontractlist[i]['contractName']);
          ranchimallflo.smartcontractnamelist.push(ranchimallflo.smartcontractlist[i]['contractName']);
          ranchimallflo.smartcontractnameaddresslist.push(ranchimallflo.smartcontractlist[i]['contractName'] + '-' + ranchimallflo.smartcontractlist[i]['contractAddress']);

        }

        for (var i = 0; i < ranchimallflo.tokenlist.length; i++) {
          //ranchimallflo.smartcontractnamelist.append(ranchimallflo.smartcontractlist[i]['contractName']);
          data.push(ranchimallflo.tokenlist[i]);
        }

        var index = new FlexSearch({

          encode: "advanced",
          tokenize: "reverse",
          suggest: true
        });

        for (var i = 0; i < data.length; i++) {
          index.add(i, data[i]);
        }



        var suggestions = document.getElementById("suggestions");
        var autocomplete = document.getElementById("autocomplete");
        var userinput = document.getElementById("userinput");

        //userinput.addEventListener("input", show_results, true);
        //userinput.addEventListener("keyup", accept_autocomplete, true);
        //suggestions.addEventListener("click", accept_suggestion, true);

        function show_results() {

          var value = this.value;
          var results = index.search(value, 25);
          var entry, childs = suggestions.childNodes;
          var i = 0, len = results.length;

          for (; i < len; i++) {

            entry = childs[i];

            if (!entry) {

              entry = document.createElement("div");
              suggestions.appendChild(entry);
            }

            entry.textContent = data[results[i]];
          }

          while (childs.length > len) {

            suggestions.removeChild(childs[i])
          }

          var first_result = data[results[0]];
          var match = first_result && first_result.toLowerCase().indexOf(value.toLowerCase());

          if (first_result && (match !== -1)) {

            autocomplete.value = value + first_result.substring(match + value.length);
            autocomplete.current = first_result;
          }
          else {

            autocomplete.value = autocomplete.current = value;
          }
        }

        function accept_autocomplete(event) {

          if ((event || window.event).keyCode === 13) {

            this.value = autocomplete.value = autocomplete.current;
          }
        }

        function accept_suggestion(event) {

          var target = (event || window.event).target;

          userinput.value = autocomplete.value = target.textContent;

          while (suggestions.lastChild) {
            suggestions.removeChild(suggestions.lastChild);
          }

          return false;
        }
      });

  </script>
</body>

</html>